### This is a draft - the refactoring of this code into OOP/classes is ongoing.
